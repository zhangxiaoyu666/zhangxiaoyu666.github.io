<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="大数据分析利器之Hive1. Hive的分桶表">
<meta name="keywords" content="Hive">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive实战">
<meta property="og:url" content="http://yoursite.com/2020/02/17/Hive实战/index.html">
<meta property="og:site_name" content="一只鱼的博客">
<meta property="og:description" content="大数据分析利器之Hive1. Hive的分桶表">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2020/02/17/Hive实战/2019-07-16_17-01-51.png">
<meta property="og:image" content="http://yoursite.com/2020/02/17/Hive实战/2019-07-16_16-30-09.png">
<meta property="og:image" content="http://yoursite.com/2020/02/17/Hive实战/1569313506031.png">
<meta property="og:image" content="http://yoursite.com/2020/02/17/Hive实战/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%AC%AC%E5%9B%9B%E6%9C%9F/8_Hive%E4%B8%8EHBase%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/1216_hive%E5%AE%9E%E6%88%98/1216_%E8%AF%BE%E5%89%8D%E9%A2%84%E4%B9%A0-Hive%20day02-hive%E5%AE%9E%E6%88%98/Hive%20day02/assets/hive%E8%A1%A8%E7%9A%84DDL%E5%92%8CDML%E6%93%8D%E4%BD%9C.png">
<meta property="og:updated_time" content="2020-02-17T11:42:48.270Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hive实战">
<meta name="twitter:description" content="大数据分析利器之Hive1. Hive的分桶表">
<meta name="twitter:image" content="http://yoursite.com/2020/02/17/Hive实战/2019-07-16_17-01-51.png">
  <link rel="canonical" href="http://yoursite.com/2020/02/17/Hive实战/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Hive实战 | 一只鱼的博客</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一只鱼的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">七秒钟的记忆多一秒</p>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-question-circle"></i>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
      
        
      
        
      
        
          
        
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-question-circle"></i>标签<span class="badge">43</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    
      
      
        
      
        
          
        
      
        
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-question-circle"></i>分类<span class="badge">10</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
      
        
          
        
      
        
      
        
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-question-circle"></i>归档<span class="badge">53</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-schedule">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/schedule/" rel="section"><i class="fa fa-fw fa-calendar"></i>日程表</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-sitemap">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-commonweal">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/404/" rel="section"><i class="fa fa-fw fa-heartbeat"></i>公益 404</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/17/Hive实战/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小鱼儿">
      <meta itemprop="description" content="肩膀有点痒，可能在长小翅膀">
      <meta itemprop="image" content="/images/fish.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一只鱼的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Hive实战

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-02-17 15:15:11 / 修改时间：19:42:48" itemprop="dateCreated datePublished" datetime="2020-02-17T15:15:11+08:00">2020-02-17</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/大数据开发/" itemprop="url" rel="index"><span itemprop="name">大数据开发</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="大数据分析利器之Hive"><a href="#大数据分析利器之Hive" class="headerlink" title="大数据分析利器之Hive"></a>大数据分析利器之Hive</h1><h3 id="1-Hive的分桶表"><a href="#1-Hive的分桶表" class="headerlink" title="1. Hive的分桶表"></a>1. Hive的分桶表</h3><a id="more"></a>

<p><img src="/2020/02/17/Hive实战/2019-07-16_17-01-51.png" alt></p>
<h4 id="1-1-分桶表原理"><a href="#1-1-分桶表原理" class="headerlink" title="1.1 分桶表原理"></a>1.1 分桶表原理</h4><ul>
<li>分桶是相对分区进行更细粒度的划分<ul>
<li>Hive表或分区表可进一步的分桶</li>
<li>分桶将整个数据内容按照某列取hash值，对桶的个数取模的方式决定该条记录存放在哪个桶当中；具有相同hash值的数据进入到同一个文件中</li>
<li>比如按照name属性分为3个桶，就是对name属性值的hash值对3取摸，按照取模结果对数据分桶。<ul>
<li>取模结果为0的数据记录存放到一个文件</li>
<li>取模结果为1的数据记录存放到一个文件</li>
<li>取模结果为2的数据记录存放到一个文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="1-2-作用"><a href="#1-2-作用" class="headerlink" title="1.2 作用"></a>1.2 作用</h4><ul>
<li>1、取样sampling更高效。没有分区的话需要扫描整个数据集。</li>
<li>2、提升某些查询操作效率，例如map side join</li>
</ul>
<h4 id="1-3-案例演示：创建分桶表"><a href="#1-3-案例演示：创建分桶表" class="headerlink" title="1.3 案例演示：创建分桶表"></a>1.3 案例演示：创建分桶表</h4><ul>
<li>在创建分桶表之前要执行的命令</li>
<li>set hive.enforce.bucketing=true; 开启对分桶表的支持</li>
<li>set mapreduce.job.reduces=4; 设置与桶相同的reduce个数（默认只有一个reduce）</li>
<li>进入hive客户端然后执行以下命令</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> myhive;</span><br><span class="line"><span class="keyword">set</span> hive.enforce.bucketing=<span class="literal">true</span>; </span><br><span class="line"><span class="keyword">set</span> mapreduce.job.reduces=<span class="number">4</span>;  </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建分桶表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> myhive.user_buckets_demo(<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">name</span> <span class="keyword">string</span>)</span><br><span class="line">clustered <span class="keyword">by</span>(<span class="keyword">id</span>) </span><br><span class="line"><span class="keyword">into</span> <span class="number">4</span> buckets </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建普通表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user_demo(<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">name</span> <span class="keyword">string</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>准备数据文件 buckets.txt</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#在linux当中执行以下命令</span><br><span class="line">cd /kkb/install/hivedatas/</span><br><span class="line">vim user_bucket.txt</span><br><span class="line"></span><br><span class="line">1	anzhulababy1</span><br><span class="line">2	anzhulababy2</span><br><span class="line">3	anzhulababy3</span><br><span class="line">4	anzhulababy4</span><br><span class="line">5	anzhulababy5</span><br><span class="line">6	anzhulababy6</span><br><span class="line">7	anzhulababy7</span><br><span class="line">8	anzhulababy8</span><br><span class="line">9	anzhulababy9</span><br><span class="line">10	anzhulababy10</span><br></pre></td></tr></table></figure>

<ul>
<li>加载数据到普通表 user_demo 中</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/user_bucket.txt'</span>  overwrite <span class="keyword">into</span> <span class="keyword">table</span> user_demo;</span><br></pre></td></tr></table></figure>

<ul>
<li>4、加载数据到桶表user_buckets_demo中</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> user_buckets_demo <span class="keyword">select</span> * <span class="keyword">from</span> user_demo;</span><br></pre></td></tr></table></figure>

<ul>
<li>hdfs上查看表的数据目录</li>
</ul>
<p><img src="/2020/02/17/Hive实战/2019-07-16_16-30-09.png" alt></p>
<ul>
<li><p>抽样查询桶表的数据</p>
<ul>
<li>tablesample抽样语句语法：tablesample(bucket  x  out  of  y)<ul>
<li>x表示从第几个桶开始取数据</li>
<li>y与进行采样的桶数的个数、每个采样桶的采样比例有关；</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> user_buckets_demo <span class="keyword">tablesample</span>(<span class="keyword">bucket</span> <span class="number">1</span> <span class="keyword">out</span> <span class="keyword">of</span> <span class="number">2</span>);</span><br><span class="line"><span class="comment">-- 需要采样的总桶数=4/2=2个</span></span><br><span class="line"><span class="comment">-- 先从第1个桶中取出数据</span></span><br><span class="line"><span class="comment">-- 1+2=3，再从第3个桶中取出数据</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-Hive数据导入"><a href="#2-Hive数据导入" class="headerlink" title="2. Hive数据导入"></a>2. Hive数据导入</h3><h4 id="2-1-直接向表中插入数据（强烈不推荐使用）"><a href="#2-1-直接向表中插入数据（强烈不推荐使用）" class="headerlink" title="2.1 直接向表中插入数据（强烈不推荐使用）"></a>2.1 直接向表中插入数据（强烈不推荐使用）</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create table score3 like score;</span><br><span class="line">hive (myhive)&gt; insert into table score3 partition(month ='201807') values ('001','002','100');</span><br></pre></td></tr></table></figure>

<h4 id="2-2-通过load加载数据（★★★★★）"><a href="#2-2-通过load加载数据（★★★★★）" class="headerlink" title="2.2 通过load加载数据（★★★★★）"></a>2.2 通过load加载数据（★★★★★）</h4><ul>
<li>语法：</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; load data [local] inpath 'dataPath' overwrite | into table student [partition (partcol1=val1,…)];</span><br></pre></td></tr></table></figure>

<ul>
<li>通过load方式加载数据</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; load data local inpath '/kkb/install/hivedatas/score.csv' overwrite into table score3 partition(month='201806');</span><br></pre></td></tr></table></figure>

<h4 id="2-3-通过查询加载数据（★★★★★）"><a href="#2-3-通过查询加载数据（★★★★★）" class="headerlink" title="2.3 通过查询加载数据（★★★★★）"></a>2.3 通过查询加载数据（★★★★★）</h4><ul>
<li>通过查询方式加载数据</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create table score5 like score;</span><br><span class="line">hive (myhive)&gt; insert overwrite table score5 partition(month = '201806') select s_id,c_id,s_score from score;</span><br></pre></td></tr></table></figure>

<h4 id="2-4-查询语句中创建表并加载数据（as-select）"><a href="#2-4-查询语句中创建表并加载数据（as-select）" class="headerlink" title="2.4 查询语句中创建表并加载数据（as select）"></a>2.4 查询语句中创建表并加载数据（as select）</h4><ul>
<li>将查询的结果保存到一张表当中去</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create table score6 as select * from score;</span><br></pre></td></tr></table></figure>

<h4 id="2-5-创建表时指定location"><a href="#2-5-创建表时指定location" class="headerlink" title="2.5 创建表时指定location"></a>2.5 创建表时指定location</h4><ul>
<li>创建表，并指定在hdfs上的位置</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create external table score7 (s_id string,c_id string,s_score int) row format delimited fields terminated by '\t' location '/myscore7';</span><br></pre></td></tr></table></figure>

<ul>
<li>上传数据到hdfs上，我们也可以直接在hive客户端下面通过dfs命令来进行操作hdfs的数据</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; dfs -mkdir -p /myscore7;</span><br><span class="line">hive (myhive)&gt; dfs -put /kkb/install/hivedatas/score.csv /myscore7;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询数据</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; select * from score7;</span><br></pre></td></tr></table></figure>

<h4 id="2-6-export导出与import-导入-hive表数据（内部表操作）"><a href="#2-6-export导出与import-导入-hive表数据（内部表操作）" class="headerlink" title="2.6 export导出与import 导入 hive表数据（内部表操作）"></a>2.6 export导出与import 导入 hive表数据（内部表操作）</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive (myhive)&gt; create table teacher2 like teacher;</span><br><span class="line">hive (myhive)&gt; export table teacher to  '/kkb/teacher';</span><br><span class="line">hive (myhive)&gt; import table teacher2 from '/kkb/teacher';</span><br></pre></td></tr></table></figure>

<h3 id="3-Hive数据导出"><a href="#3-Hive数据导出" class="headerlink" title="3. Hive数据导出"></a>3. Hive数据导出</h3><h4 id="3-1-insert-导出"><a href="#3-1-insert-导出" class="headerlink" title="3.1 insert 导出"></a>3.1 insert 导出</h4><ul>
<li>将查询的结果导出到本地</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/stu'</span> <span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>

<ul>
<li>将查询的结果<strong>格式化</strong>导出到本地</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/stu2'</span> <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span> <span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>

<ul>
<li>将查询的结果导出到HDFS上(没有local)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">directory</span> <span class="string">'/kkb/hivedatas/stu'</span> <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span>  <span class="string">','</span>  <span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-Hive-Shell-命令导出"><a href="#3-2-Hive-Shell-命令导出" class="headerlink" title="3.2  Hive Shell 命令导出"></a>3.2  Hive Shell 命令导出</h4><ul>
<li>基本语法：<ul>
<li>hive -e “sql语句” &gt;   file</li>
<li>hive -f  sql文件   &gt;    file</li>
</ul>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive -e 'select * from myhive.stu;' &gt; /kkb/install/hivedatas/student1.txt</span><br></pre></td></tr></table></figure>

<h4 id="3-3-export导出到HDFS上"><a href="#3-3-export导出到HDFS上" class="headerlink" title="3.3 export导出到HDFS上"></a>3.3 export导出到HDFS上</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export table  myhive.stu to '/kkb/<span class="keyword">install</span>/hivedatas/stuexport<span class="string">';</span></span><br></pre></td></tr></table></figure>

<h3 id="4-Hive的静态分区和动态分区"><a href="#4-Hive的静态分区和动态分区" class="headerlink" title="4. Hive的静态分区和动态分区"></a>4. Hive的静态分区和动态分区</h3><h4 id="4-1-静态分区"><a href="#4-1-静态分区" class="headerlink" title="4.1 静态分区"></a>4.1 静态分区</h4><ul>
<li>表的分区字段的值需要开发人员手动给定</li>
<li>创建分区表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> myhive;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> order_partition(</span><br><span class="line">order_number <span class="keyword">string</span>,</span><br><span class="line">order_price  <span class="keyword">double</span>,</span><br><span class="line">order_time <span class="keyword">string</span></span><br><span class="line">)</span><br><span class="line">partitioned <span class="keyword">BY</span>(<span class="keyword">month</span> <span class="keyword">string</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>准备数据</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hivedatas</span><br><span class="line">vim order.txt </span><br><span class="line"></span><br><span class="line">10001	100	2019-03-02</span><br><span class="line">10002	200	2019-03-02</span><br><span class="line">10003	300	2019-03-02</span><br><span class="line">10004	400	2019-03-03</span><br><span class="line">10005	500	2019-03-03</span><br><span class="line">10006	600	2019-03-03</span><br><span class="line">10007	700	2019-03-04</span><br><span class="line">10008	800	2019-03-04</span><br><span class="line">10009	900	2019-03-04</span><br></pre></td></tr></table></figure>

<ul>
<li>加载数据到分区表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/order.txt'</span> overwrite <span class="keyword">into</span> <span class="keyword">table</span> order_partition <span class="keyword">partition</span>(<span class="keyword">month</span>=<span class="string">'2019-03'</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>4、查询结果数据    </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> order_partition <span class="keyword">where</span> <span class="keyword">month</span>=<span class="string">'2019-03'</span>;</span><br><span class="line">结果为：</span><br><span class="line">  </span><br><span class="line">10001   100.0   2019-03-02      2019-03</span><br><span class="line">10002   200.0   2019-03-02      2019-03</span><br><span class="line">10003   300.0   2019-03-02      2019-03</span><br><span class="line">10004   400.0   2019-03-03      2019-03</span><br><span class="line">10005   500.0   2019-03-03      2019-03</span><br><span class="line">10006   600.0   2019-03-03      2019-03</span><br><span class="line">10007   700.0   2019-03-04      2019-03</span><br><span class="line">10008   800.0   2019-03-04      2019-03</span><br><span class="line">10009   900.0   2019-03-04      2019-03</span><br></pre></td></tr></table></figure>

<h4 id="4-2-动态分区"><a href="#4-2-动态分区" class="headerlink" title="4.2 动态分区"></a>4.2 动态分区</h4><ul>
<li>按照需求实现把数据自动导入到表的不同分区中，不需要手动指定</li>
<li><strong>需求：根据分区字段不同的值，自动将数据导入到分区表不同的分区中</strong> </li>
<li>创建表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建普通表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_order(</span><br><span class="line">    order_number <span class="keyword">string</span>,</span><br><span class="line">    order_price  <span class="keyword">double</span>, </span><br><span class="line">    order_time   <span class="keyword">string</span></span><br><span class="line">)<span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建目标分区表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> order_dynamic_partition(</span><br><span class="line">    order_number <span class="keyword">string</span>,</span><br><span class="line">    order_price  <span class="keyword">double</span>    </span><br><span class="line">)partitioned <span class="keyword">BY</span>(order_time <span class="keyword">string</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>准备数据</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd /kkb/install/hivedatas</span><br><span class="line">vim order_partition.txt</span><br><span class="line"></span><br><span class="line">10001	100	2019-03-02 </span><br><span class="line">10002	200	2019-03-02</span><br><span class="line">10003	300	2019-03-02</span><br><span class="line">10004	400	2019-03-03</span><br><span class="line">10005	500	2019-03-03</span><br><span class="line">10006	600	2019-03-03</span><br><span class="line">10007	700	2019-03-04</span><br><span class="line">10008	800	2019-03-04</span><br><span class="line">10009	900	2019-03-04</span><br></pre></td></tr></table></figure>

<ul>
<li>向普通表t_order加载数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/order_partition.txt'</span> overwrite <span class="keyword">into</span> <span class="keyword">table</span> t_order;</span><br></pre></td></tr></table></figure>

<ul>
<li>动态加载数据到分区表中</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 要想进行动态分区，需要设置参数</span></span><br><span class="line"><span class="comment">-- 开启动态分区功能</span></span><br><span class="line">hive&gt; set hive.exec.dynamic.partition=true; </span><br><span class="line"><span class="comment">-- 设置hive为非严格模式</span></span><br><span class="line">hive&gt; set hive.exec.dynamic.partition.mode=nonstrict; </span><br><span class="line">hive&gt; insert into table order_dynamic_partition partition(order_time) select order_number, order_price, order_time from t_order;</span><br></pre></td></tr></table></figure>

<ul>
<li>查看分区</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; show partitions order_dynamic_partition;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/17/Hive实战/1569313506031.png" alt></p>
<h3 id="5-Hive的查询语法"><a href="#5-Hive的查询语法" class="headerlink" title="5. Hive的查询语法"></a>5. Hive的查询语法</h3><h4 id="5-1-基本查询"><a href="#5-1-基本查询" class="headerlink" title="5.1 基本查询"></a>5.1 基本查询</h4><ul>
<li>注意<ul>
<li>SQL 语言大小写不敏感</li>
<li>SQL 可以写在一行或者多行</li>
<li>关键字不能被缩写也不能分行</li>
<li>各子句一般要分行写</li>
<li>使用缩进提高语句的可读性</li>
</ul>
</li>
</ul>
<h5 id="5-1-1-查询全表和特定列"><a href="#5-1-1-查询全表和特定列" class="headerlink" title="5.1.1 查询全表和特定列"></a>5.1.1 查询全表和特定列</h5><ul>
<li>全表查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>

<ul>
<li>选择特定列查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-2-列起别名"><a href="#5-1-2-列起别名" class="headerlink" title="5.1.2 列起别名"></a>5.1.2 列起别名</h5><ul>
<li>重命名一个列<ul>
<li>紧跟列名，也可以在列名和别名之间加入关键字 ‘as’ </li>
</ul>
</li>
<li>案例实操</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">as</span> stuName <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-3-常用函数"><a href="#5-1-3-常用函数" class="headerlink" title="5.1.3 常用函数"></a>5.1.3 常用函数</h5><ul>
<li>求总行数（count）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) cnt <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>

<ul>
<li>求分数的最大值（max）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>

<ul>
<li>求分数的最小值（min）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">min</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>

<ul>
<li>求分数的总和（sum）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>

<ul>
<li>求分数的平均值（avg）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(s_score) <span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-4-limit-语句"><a href="#5-1-4-limit-语句" class="headerlink" title="5.1.4 limit 语句"></a>5.1.4 limit 语句</h5><ul>
<li>imit子句用于限制返回的行数。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> score <span class="keyword">limit</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-5-where-语句"><a href="#5-1-5-where-语句" class="headerlink" title="5.1.5 where 语句"></a>5.1.5 where 语句</h5><ul>
<li>使用 where 子句，将不满足条件的行过滤掉</li>
<li>where 子句紧随from子句</li>
<li>案例实操</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> score <span class="keyword">where</span> s_score &gt; <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-6-算术运算符"><a href="#5-1-6-算术运算符" class="headerlink" title="5.1.6 算术运算符"></a>5.1.6 算术运算符</h5><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>A+B</td>
<td>A和B 相加</td>
</tr>
<tr>
<td>A-B</td>
<td>A减去B</td>
</tr>
<tr>
<td>A*B</td>
<td>A和B 相乘</td>
</tr>
<tr>
<td>A/B</td>
<td>A除以B</td>
</tr>
<tr>
<td>A%B</td>
<td>A对B取余</td>
</tr>
<tr>
<td>A&amp;B</td>
<td>A和B按位取与</td>
</tr>
<tr>
<td>A|B</td>
<td>A和B按位取或</td>
</tr>
<tr>
<td>A^B</td>
<td>A和B按位取异或</td>
</tr>
<tr>
<td>~A</td>
<td>A按位取反</td>
</tr>
</tbody></table>
<h5 id="5-1-7-比较运算符"><a href="#5-1-7-比较运算符" class="headerlink" title="5.1.7 比较运算符"></a>5.1.7 比较运算符</h5><table>
<thead>
<tr>
<th align="center">操作符</th>
<th align="center">支持的数据类型</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">A=B</td>
<td align="center">基本数据类型</td>
<td align="center">如果A等于B则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">A&lt;=&gt;B</td>
<td align="center">基本数据类型</td>
<td align="center">如果A和B都为NULL，则返回true，其他的和等号（=）操作符的结果一致，如果任一为NULL则结果为NULL</td>
</tr>
<tr>
<td align="center">A&lt;&gt;B, A!=B</td>
<td align="center">基本数据类型</td>
<td align="center">A或者B为NULL则返回NULL；如果A不等于B，则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">A&lt;B</td>
<td align="center">基本数据类型</td>
<td align="center">A或者B为NULL，则返回NULL；如果A小于B，则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">A&lt;=B</td>
<td align="center">基本数据类型</td>
<td align="center">A或者B为NULL，则返回NULL；如果A小于等于B，则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">A&gt;B</td>
<td align="center">基本数据类型</td>
<td align="center">A或者B为NULL，则返回NULL；如果A大于B，则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">A&gt;=B</td>
<td align="center">基本数据类型</td>
<td align="center">A或者B为NULL，则返回NULL；如果A大于等于B，则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">A [NOT] BETWEEN B AND C</td>
<td align="center">基本数据类型</td>
<td align="center">如果A，B或者C任一为NULL，则结果为NULL。如果A的值大于等于B而且小于或等于C，则结果为true，反之为false。如果使用NOT关键字则可达到相反的效果。</td>
</tr>
<tr>
<td align="center">A IS NULL</td>
<td align="center">所有数据类型</td>
<td align="center">如果A等于NULL，则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">A IS NOT NULL</td>
<td align="center">所有数据类型</td>
<td align="center">如果A不等于NULL，则返回true，反之返回false</td>
</tr>
<tr>
<td align="center">IN(数值1, 数值2)</td>
<td align="center">所有数据类型</td>
<td align="center">使用 IN运算显示列表中的值</td>
</tr>
<tr>
<td align="center">A [NOT] LIKE B</td>
<td align="center">STRING 类型</td>
<td align="center">B是一个SQL下的简单正则表达式，如果A与其匹配的话，则返回true；反之返回false。B的表达式说明如下：‘x%’表示A必须以字母‘x’开头，‘%x’表示A必须以字母’x’结尾，而‘%x%’表示A包含有字母’x’,可以位于开头，结尾或者字符串中间。如果使用NOT关键字则可达到相反的效果。like不是正则，而是通配符</td>
</tr>
<tr>
<td align="center">A RLIKE B, A REGEXP B</td>
<td align="center">STRING 类型</td>
<td align="center">B是一个正则表达式，如果A与其匹配，则返回true；反之返回false。匹配使用的是JDK中的正则表达式接口实现的，因为正则也依据其中的规则。例如，正则表达式必须和整个字符串A相匹配，而不是只需与其字符串匹配。</td>
</tr>
</tbody></table>
<h5 id="5-1-8-逻辑运算符"><a href="#5-1-8-逻辑运算符" class="headerlink" title="5.1.8 逻辑运算符"></a>5.1.8 逻辑运算符</h5><table>
<thead>
<tr>
<th align="center">操作符</th>
<th align="center">操作</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">A AND  B</td>
<td align="center">逻辑并</td>
<td align="center">如果A和B都是true则为true，否则false</td>
</tr>
<tr>
<td align="center">A  OR  B</td>
<td align="center">逻辑或</td>
<td align="center">如果A或B或两者都是true则为true，否则false</td>
</tr>
<tr>
<td align="center">NOT  A</td>
<td align="center">逻辑否</td>
<td align="center">如果A为false则为true,否则false</td>
</tr>
</tbody></table>
<h4 id="5-2-分组"><a href="#5-2-分组" class="headerlink" title="5.2 分组"></a>5.2 分组</h4><h5 id="5-2-1-Group-By-语句"><a href="#5-2-1-Group-By-语句" class="headerlink" title="5.2.1 Group By 语句"></a>5.2.1 Group By 语句</h5><ul>
<li><p>Group By语句通常会和聚合函数一起使用，按照一个或者多个列对结果进行分组，然后对每个组执行聚合操作。</p>
</li>
<li><p>案例实操：</p>
<ul>
<li>计算每个学生的平均分数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id,<span class="keyword">avg</span>(s_score) <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id;</span><br></pre></td></tr></table></figure>

<ul>
<li>计算每个学生最高的分数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id,<span class="keyword">max</span>(s_score) <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>hive这样写会报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from score group by s_id</span><br></pre></td></tr></table></figure>

<h5 id="5-2-2-Having语句"><a href="#5-2-2-Having语句" class="headerlink" title="5.2.2 Having语句"></a>5.2.2 Having语句</h5><ul>
<li><p>having 与 where 不同点</p>
<ul>
<li>where针对表中的列发挥作用，查询数据；having针对查询结果中的列发挥作用，筛选数据</li>
<li>where后面不能写分组函数，而having后面可以使用分组函数</li>
<li>having只用于group by分组统计语句</li>
</ul>
</li>
<li><p>案例实操</p>
<ul>
<li>求每个学生的平均分数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id, <span class="keyword">avg</span>(s_score) <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id;</span><br></pre></td></tr></table></figure>

<ul>
<li>求每个学生平均分数大于60的人</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id, <span class="keyword">avg</span>(s_score) <span class="keyword">as</span> avgScore <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id <span class="keyword">having</span> avgScore &gt; <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="5-3-join语句"><a href="#5-3-join语句" class="headerlink" title="5.3 join语句"></a>5.3 join语句</h4><h5 id="5-3-1-等值-join"><a href="#5-3-1-等值-join" class="headerlink" title="5.3.1 等值 join"></a>5.3.1 等值 join</h5><ul>
<li><p>Hive支持通常的SQL JOIN语句，但是只支持等值连接，==不支持非等值连接==。</p>
</li>
<li><p>案例实操</p>
<ul>
<li>根据学生和成绩表，查询学生姓名对应的成绩</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> stu <span class="keyword">left</span> <span class="keyword">join</span> score <span class="keyword">on</span> stu.id = score.s_id</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-3-2-表的别名"><a href="#5-3-2-表的别名" class="headerlink" title="5.3.2 表的别名"></a>5.3.2 表的别名</h5><ul>
<li><p>好处</p>
<ul>
<li>使用别名可以简化查询。</li>
<li>使用表名前缀可以提高执行效率。</li>
</ul>
</li>
<li><p>案例实操：合并老师与课程表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- hive当中创建course表并加载数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course (c_id <span class="keyword">string</span>, c_name <span class="keyword">string</span>, t_id <span class="keyword">string</span>) </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/kkb/install/hivedatas/course.csv'</span> overwrite <span class="keyword">into</span> <span class="keyword">table</span> course;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">join</span> course c <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-3-3-内连接-inner-join"><a href="#5-3-3-内连接-inner-join" class="headerlink" title="5.3.3 内连接 inner join"></a>5.3.3 内连接 inner join</h5><ul>
<li><p>内连接：只有进行连接的两个表中都存在与连接条件相匹配的数据才会被保留下来。</p>
<ul>
<li>join默认是inner  join</li>
</ul>
</li>
<li><p>案例实操</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">inner</span> <span class="keyword">join</span> course c  <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-3-4-左外连接-left-outer-join"><a href="#5-3-4-左外连接-left-outer-join" class="headerlink" title="5.3.4 左外连接 left outer join"></a>5.3.4 左外连接 left outer join</h5><ul>
<li><p>左外连接：</p>
<ul>
<li>join操作符左边表中符合where子句的所有记录将会被返回。</li>
<li>右边表的指定字段没有符合条件的值的话，那么就使用null值替代。</li>
</ul>
</li>
<li><p>案例实操：查询老师对应的课程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> course c <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-3-5-右外连接-right-outer-join"><a href="#5-3-5-右外连接-right-outer-join" class="headerlink" title="5.3.5 右外连接 right outer join"></a>5.3.5 右外连接 right outer join</h5><ul>
<li><p>右外连接：</p>
<ul>
<li>join操作符==右边表中==符合where子句的所有记录将会被返回。</li>
<li>左边表的指定字段没有符合条件的值的话，那么就使用null值替代。</li>
</ul>
</li>
<li><p>案例实操</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> course c <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-3-6-满外连接-full-outer-join"><a href="#5-3-6-满外连接-full-outer-join" class="headerlink" title="5.3.6 满外连接 full outer join"></a>5.3.6 满外连接 full outer join</h5><ul>
<li><p>满外连接：</p>
<ul>
<li>将会返回==所有表中==符合where语句条件的所有记录。</li>
<li>如果任一表的指定字段没有符合条件的值的话，那么就使用null值替代。</li>
</ul>
</li>
<li><p>案例实操</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> course c <span class="keyword">on</span> t.t_id = c.t_id;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-3-7-多表连接"><a href="#5-3-7-多表连接" class="headerlink" title="5.3.7 多表连接"></a>5.3.7 多表连接</h5><ul>
<li><p><strong>多个表使用join进行连接</strong></p>
</li>
<li><p>注意：连接 n个表，至少需要n-1个连接条件。例如：连接三个表，至少需要两个连接条件。</p>
</li>
<li><p>案例实操</p>
<ul>
<li>多表连接查询，查询老师对应的课程，以及对应的分数，对应的学生</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher t </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> course c <span class="keyword">on</span> t.t_id = c.t_id </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> score s <span class="keyword">on</span> c.c_id = s.c_id </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> stu <span class="keyword">on</span> s.s_id = stu.id;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="5-4-排序"><a href="#5-4-排序" class="headerlink" title="5.4 排序"></a>5.4 排序</h4><h5 id="5-4-1-order-by-全局排序"><a href="#5-4-1-order-by-全局排序" class="headerlink" title="5.4.1 order by 全局排序"></a>5.4.1 order by 全局排序</h5><ul>
<li><p>全局排序，只有一个reduce</p>
</li>
<li><p>使用 ORDER BY 子句排序</p>
<ul>
<li>asc ( ascend) 升序 (默认)</li>
<li>desc (descend) 降序</li>
</ul>
</li>
<li><p>order by 子句在select语句的结尾</p>
</li>
<li><p>案例实操</p>
<ul>
<li>查询学生的成绩，并按照分数降序排列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> score s <span class="keyword">order</span> <span class="keyword">by</span> s_score <span class="keyword">desc</span> ;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-4-2-按照别名排序"><a href="#5-4-2-按照别名排序" class="headerlink" title="5.4.2 按照别名排序"></a>5.4.2 按照别名排序</h5><ul>
<li><p>按照学生分数的平均值排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s_id, <span class="keyword">avg</span>(s_score) avgscore <span class="keyword">from</span> score <span class="keyword">group</span> <span class="keyword">by</span> s_id <span class="keyword">order</span> <span class="keyword">by</span> avgscore <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-4-3-每个MapReduce内部排序（Sort-By）局部排序"><a href="#5-4-3-每个MapReduce内部排序（Sort-By）局部排序" class="headerlink" title="5.4.3 每个MapReduce内部排序（Sort By）局部排序"></a>5.4.3 每个MapReduce内部排序（Sort By）局部排序</h5><ul>
<li><p>sort by：每个reducer内部进行排序，对全局结果集来说不是排序。</p>
</li>
<li><p>设置reduce个数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set mapreduce.job.reduces=3;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看reduce的个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> mapreduce.job.reduces;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询成绩按照成绩降序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> score s <span class="keyword">sort</span> <span class="keyword">by</span> s.s_score;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将查询结果导入到文件中（按照成绩降序排列）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/sort'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score s <span class="keyword">sort</span> <span class="keyword">by</span> s.s_score;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-4-4-distribute-by-分区排序"><a href="#5-4-4-distribute-by-分区排序" class="headerlink" title="5.4.4 distribute by 分区排序"></a>5.4.4 distribute by 分区排序</h5><ul>
<li><p>distribute by：</p>
<ul>
<li>类似MR中partition，采集hash算法，在map端将查询的结果中hash值相同的结果分发到对应的reduce文件中。</li>
<li>结合sort by使用。</li>
</ul>
</li>
<li><p>注意</p>
<ul>
<li>Hive要求 <strong>distribute by</strong> 语句要写在 <strong>sort by</strong> 语句之前。</li>
</ul>
</li>
<li><p>案例实操</p>
<ul>
<li>先按照学生 sid 进行分区，再按照学生成绩进行排序</li>
<li>设置reduce的个数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> mapreduce.job.reduces=<span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>通过distribute by  进行数据的分区,，将不同的sid 划分到对应的reduce当中去</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/distribute'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score <span class="keyword">distribute</span> <span class="keyword">by</span> s_id <span class="keyword">sort</span> <span class="keyword">by</span> s_score;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-4-5-cluster-by"><a href="#5-4-5-cluster-by" class="headerlink" title="5.4.5 cluster by"></a>5.4.5 cluster by</h5><ul>
<li><p>当distribute by和sort by字段相同时，可以使用cluster by方式代替</p>
</li>
<li><p>除了distribute by 的功能外，还会对该字段进行排序，所以cluster by = distribute by + sort by</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--以下两种写法等价</span></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/distribute_sort'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score <span class="keyword">distribute</span> <span class="keyword">by</span> s_score <span class="keyword">sort</span> <span class="keyword">by</span> s_score;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> overwrite <span class="keyword">local</span> <span class="keyword">directory</span> <span class="string">'/kkb/install/hivedatas/cluster'</span> <span class="keyword">select</span> * <span class="keyword">from</span> score  cluster <span class="keyword">by</span> s_score;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h2><p><img src="/2020/02/17/Hive实战/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%AC%AC%E5%9B%9B%E6%9C%9F/8_Hive%E4%B8%8EHBase%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/1216_hive%E5%AE%9E%E6%88%98/1216_%E8%AF%BE%E5%89%8D%E9%A2%84%E4%B9%A0-Hive%20day02-hive%E5%AE%9E%E6%88%98/Hive%20day02/assets/hive%E8%A1%A8%E7%9A%84DDL%E5%92%8CDML%E6%93%8D%E4%BD%9C.png" alt></p>
<h2 id="七、作业"><a href="#七、作业" class="headerlink" title="七、作业"></a>七、作业</h2><ul>
<li>1、创建一张hive的表，加载数据，最后把查询的结果数据导入到本地文件中</li>
<li>2、创建一张hive外部分区表，实现从一个已知的表中查询数据，动态插入到指定的分区中</li>
</ul>

    </div>

    
    
    
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>小鱼儿</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yoursite.com/2020/02/17/Hive实战/" title="Hive实战">http://yoursite.com/2020/02/17/Hive实战/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-Hans" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/Hive/" rel="tag"># Hive</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/02/17/Hive原理与优化/" rel="next" title="Hive原理与优化">
                  <i class="fa fa-chevron-left"></i> Hive原理与优化
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#大数据分析利器之Hive"><span class="nav-number">1.</span> <span class="nav-text">大数据分析利器之Hive</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Hive的分桶表"><span class="nav-number">1.0.1.</span> <span class="nav-text">1. Hive的分桶表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-分桶表原理"><span class="nav-number">1.0.1.1.</span> <span class="nav-text">1.1 分桶表原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-作用"><span class="nav-number">1.0.1.2.</span> <span class="nav-text">1.2 作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-案例演示：创建分桶表"><span class="nav-number">1.0.1.3.</span> <span class="nav-text">1.3 案例演示：创建分桶表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Hive数据导入"><span class="nav-number">1.0.2.</span> <span class="nav-text">2. Hive数据导入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-直接向表中插入数据（强烈不推荐使用）"><span class="nav-number">1.0.2.1.</span> <span class="nav-text">2.1 直接向表中插入数据（强烈不推荐使用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-通过load加载数据（★★★★★）"><span class="nav-number">1.0.2.2.</span> <span class="nav-text">2.2 通过load加载数据（★★★★★）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-通过查询加载数据（★★★★★）"><span class="nav-number">1.0.2.3.</span> <span class="nav-text">2.3 通过查询加载数据（★★★★★）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-查询语句中创建表并加载数据（as-select）"><span class="nav-number">1.0.2.4.</span> <span class="nav-text">2.4 查询语句中创建表并加载数据（as select）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-创建表时指定location"><span class="nav-number">1.0.2.5.</span> <span class="nav-text">2.5 创建表时指定location</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-export导出与import-导入-hive表数据（内部表操作）"><span class="nav-number">1.0.2.6.</span> <span class="nav-text">2.6 export导出与import 导入 hive表数据（内部表操作）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Hive数据导出"><span class="nav-number">1.0.3.</span> <span class="nav-text">3. Hive数据导出</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-insert-导出"><span class="nav-number">1.0.3.1.</span> <span class="nav-text">3.1 insert 导出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-Hive-Shell-命令导出"><span class="nav-number">1.0.3.2.</span> <span class="nav-text">3.2  Hive Shell 命令导出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-export导出到HDFS上"><span class="nav-number">1.0.3.3.</span> <span class="nav-text">3.3 export导出到HDFS上</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Hive的静态分区和动态分区"><span class="nav-number">1.0.4.</span> <span class="nav-text">4. Hive的静态分区和动态分区</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-静态分区"><span class="nav-number">1.0.4.1.</span> <span class="nav-text">4.1 静态分区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-动态分区"><span class="nav-number">1.0.4.2.</span> <span class="nav-text">4.2 动态分区</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-Hive的查询语法"><span class="nav-number">1.0.5.</span> <span class="nav-text">5. Hive的查询语法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-基本查询"><span class="nav-number">1.0.5.1.</span> <span class="nav-text">5.1 基本查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-1-查询全表和特定列"><span class="nav-number">1.0.5.1.1.</span> <span class="nav-text">5.1.1 查询全表和特定列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-2-列起别名"><span class="nav-number">1.0.5.1.2.</span> <span class="nav-text">5.1.2 列起别名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-3-常用函数"><span class="nav-number">1.0.5.1.3.</span> <span class="nav-text">5.1.3 常用函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-4-limit-语句"><span class="nav-number">1.0.5.1.4.</span> <span class="nav-text">5.1.4 limit 语句</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-5-where-语句"><span class="nav-number">1.0.5.1.5.</span> <span class="nav-text">5.1.5 where 语句</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-6-算术运算符"><span class="nav-number">1.0.5.1.6.</span> <span class="nav-text">5.1.6 算术运算符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-7-比较运算符"><span class="nav-number">1.0.5.1.7.</span> <span class="nav-text">5.1.7 比较运算符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-8-逻辑运算符"><span class="nav-number">1.0.5.1.8.</span> <span class="nav-text">5.1.8 逻辑运算符</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-分组"><span class="nav-number">1.0.5.2.</span> <span class="nav-text">5.2 分组</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-1-Group-By-语句"><span class="nav-number">1.0.5.2.1.</span> <span class="nav-text">5.2.1 Group By 语句</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-2-Having语句"><span class="nav-number">1.0.5.2.2.</span> <span class="nav-text">5.2.2 Having语句</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-join语句"><span class="nav-number">1.0.5.3.</span> <span class="nav-text">5.3 join语句</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-1-等值-join"><span class="nav-number">1.0.5.3.1.</span> <span class="nav-text">5.3.1 等值 join</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-2-表的别名"><span class="nav-number">1.0.5.3.2.</span> <span class="nav-text">5.3.2 表的别名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-3-内连接-inner-join"><span class="nav-number">1.0.5.3.3.</span> <span class="nav-text">5.3.3 内连接 inner join</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-4-左外连接-left-outer-join"><span class="nav-number">1.0.5.3.4.</span> <span class="nav-text">5.3.4 左外连接 left outer join</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-5-右外连接-right-outer-join"><span class="nav-number">1.0.5.3.5.</span> <span class="nav-text">5.3.5 右外连接 right outer join</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-6-满外连接-full-outer-join"><span class="nav-number">1.0.5.3.6.</span> <span class="nav-text">5.3.6 满外连接 full outer join</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3-7-多表连接"><span class="nav-number">1.0.5.3.7.</span> <span class="nav-text">5.3.7 多表连接</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-排序"><span class="nav-number">1.0.5.4.</span> <span class="nav-text">5.4 排序</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-1-order-by-全局排序"><span class="nav-number">1.0.5.4.1.</span> <span class="nav-text">5.4.1 order by 全局排序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-2-按照别名排序"><span class="nav-number">1.0.5.4.2.</span> <span class="nav-text">5.4.2 按照别名排序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-3-每个MapReduce内部排序（Sort-By）局部排序"><span class="nav-number">1.0.5.4.3.</span> <span class="nav-text">5.4.3 每个MapReduce内部排序（Sort By）局部排序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-4-distribute-by-分区排序"><span class="nav-number">1.0.5.4.4.</span> <span class="nav-text">5.4.4 distribute by 分区排序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-5-cluster-by"><span class="nav-number">1.0.5.4.5.</span> <span class="nav-text">5.4.5 cluster by</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#六、总结"><span class="nav-number">1.1.</span> <span class="nav-text">六、总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#七、作业"><span class="nav-number">1.2.</span> <span class="nav-text">七、作业</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/fish.png"
      alt="小鱼儿">
  <p class="site-author-name" itemprop="name">小鱼儿</p>
  <div class="site-description" itemprop="description">肩膀有点痒，可能在长小翅膀</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    
  
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-Hans" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小鱼儿</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/pisces.js?v=7.4.1"></script>

<script src="/js/next-boot.js?v=7.4.1"></script>



  





















  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>

